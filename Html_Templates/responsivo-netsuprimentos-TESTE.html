<!DOCTYPE html>
<html class="no-js" lang="pt-br" xmlns:vtex="http://www.vtex.com.br/2009/vtex-common" xmlns:vtex.cmc="http://www.vtex.com.br/2009/vtex-commerce">

<head>
    <vtex:template id="responsivo-netsuprimentos-includes-header" />
    <link rel="stylesheet" href="/arquivos/netsuprimentos-page-sistema.min.css" />
    <link rel="stylesheet" href="/arquivos/netsuprimentos-main-teste.min.css" />
</head>

<body>
    <div class="tpl-wrapper">
        <!-- HEADER -->
        <vtex:template id="responsivo-netsuprimentos-header-teste" />

        <!-- MAIN -->
        <main id="main">
            <div class="tpl-content">
                <div class="tpl-center">
                    <div class="search-header row" style="padding: 200px 0;">
                        <p>PÃ¡gina Tester</p>
                        <h2>Filtrar Produtos</h2>
                        <div class="form-group">
                            <label for="campoBusca">Digite algo</label>
                            <input id="campoBusca" class="form-control" type="text">
                        </div>

                        <ul id="listaTarefasFiltradas" class="list-group"></ul>
                    </div>
                </div>
                <!-- FIM tpl-center -->
            </div>
            <!-- fim tpl-content -->
        </main>
        <!-- fim main -->

        <!-- FOOTER -->
        <vtex:template id="responsivo-netsuprimentos-footer" />

    </div>
    <!-- fim tpl-wrapper -->

    <!-- SCRIPTS -->
    <vtex:template id="responsivo-netsuprimentos-includes-scripts" />
    <script>
        campoBusca.onkeyup = function(e) {
            var valorDigitado = this.value;

            if (!valorDigitado) {
                return;
            }

            if (e.key === "Backspace") {
                return;
            }

            window.clearInterval(window.espera);

            window.espera = setTimeout(function() {          
                // AutoComplete
                fetch(
                "https://api.linximpulse.com/engage/search/v3/autocompletes?apiKey=netsuprimentos&secretKey=kYmCE9OyMNmhZuOOcZlacQ==&prefix=" +
                    valorDigitado,
                    {
                        method: "GET",
                        headers: {
                        Accept: "application/json",
                        "Content-Type": "application/json"
                        }
                    }
                )
                .then(response => response.json())
                .then(response => {
                    Object.entries(response.products).forEach(([key, value]) => {
                    console.log(
                        " value nome => " + value.name + " value preco => " + value.price
                    );
                    });
                });
            }, 400);
        };
    </script>
</body>

</html>

